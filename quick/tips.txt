////////////////////////////////////////////////////////
/// SIMPLE RUN

./waf --run="main --run_dir='../runs/example_single'"
NS_LOG="SomeClass=all" ./waf --run="main --run_dir='../runs/example_single'"

////////////////////////////////////////////////////////
/// DEBUG EVENT QUEUE

If you want to debug the event queue, add:

Simulator::GetImplementation()->GetObject<DefaultSimulatorImpl>()->PrintInfoEventQueue();

void
DefaultSimulatorImpl::PrintInfoEventQueue (void) {
    m_events->GetObject<MapScheduler>()->DoSomething();
}

void
MapScheduler::DoSomething (void) const
{
  std::cout << "Amount of events in there: " << m_list.size() << std::endl;
}

////////////////////////////////////////////////////////
/// MEMORY CHECK USING VALGRIND

# Heap usage analysis
rm -rf ../runs/example_big_grid_one_flow/logs_ns3
mkdir ../runs/example_big_grid_one_flow/logs_ns3
./waf --command-template="valgrind --time-unit=ms --max-snapshots=500 --tool=massif %s --run_dir='../runs/example_single_many_small_flows'" --run "main" 2>&1 | tee ../runs/example_single_many_small_flows/logs_ns3/console.txt
massif-visualizer [massif file]

# Memory leak check
rm -rf ../runs/example_single/logs_ns3
mkdir ../runs/example_single/logs_ns3
./waf --command-template="valgrind %s --run_dir='../runs/example_single'" --run "main" 2>&1 | tee ../runs/example_single/logs_ns3/console.txt

////////////////////////////////////////////////////////
/// SAVE NS-3 OUTPUT

# To show all NS-3 logs:
NS_LOG="*=*|all" ./waf --run="main --run_dir='../runs/example_single'" &> a.txt

////////////////////////////////////////////////////////
/// TRACK NETWORK DEVICE QUEUE SIZE

#include <fstream>

std::ofstream ofs;
ofs.open ("queue.txt");
ofs.close();

container.Get(0)->GetObject<PointToPointNetDevice>()->GetQueue()->TraceConnectWithoutContext(
        "PacketsInQueue", MakeCallback(&QueueChangeA));

static void
QueueChangeA (uint32_t oldNumPackets, uint32_t newNumPackets) {
    std::ofstream ofs;
    ofs.open("queue.txt", std::ofstream::out | std::ofstream::app);
    ofs << Simulator::Now().GetSeconds() << "\t" << newNumPackets << std::endl;
    ofs.close();
}

////////////////////////////////////////////////////////
/// TRACK CONGESTION WINDOW SIZE

#include <fstream>

std::ofstream ofs;
ofs.open ("cwnd.txt");
ofs.close();

m_socket->TraceConnectWithoutContext ("CongestionWindow",
        MakeCallback (&CwndChange));

static void
CwndChange (uint32_t oldCwnd, uint32_t newCwnd)
{
    std::ofstream ofs;
    ofs.open ("cwnd.txt", std::ofstream::out | std::ofstream::app);
    ofs << Simulator::Now ().GetSeconds () << "\t" << newCwnd << std::endl;
    ofs.close();
}

////////////////////////////////////////////////////////
/// TRACK RTT

#include <fstream>

std::ofstream ofs;
ofs.open ("rtt.txt");
ofs.close();

void RttChange (Time oldT, Time newT);

m_socket->TraceConnectWithoutContext ("RTT", MakeCallback (&FlowSendApplication::RttChange, this));

void
FlowSendApplication::RttChange (Time oldT, Time newT)
{
    std::ofstream ofs;
    ofs.open ("rtt.txt", std::ofstream::out | std::ofstream::app);
    ofs << m_flowId << "\t" << Simulator::Now ().GetSeconds () << "\t" << newT.GetSeconds() << std::endl;
    ofs.close();
}
